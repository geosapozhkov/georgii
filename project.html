<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="referrer" content="no-referrer">
  <title>Project</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <link rel="stylesheet" href="css/styles.css?v=49">
</head>
<body class="p-1.5">
  <header class="flex items-start mb-12 px-1.5 relative">
    <h1 id="project-title" class="text-4xl font-bold tracking-tight mr-4" style="display: none;"></h1>
    <nav id="breadcrumb" class="text-gray-500 flex flex-wrap gap-2" style="position: absolute; left: calc(40% + 200px); padding-left: 1.5rem; align-items: baseline;"></nav>
    <nav id="top-nav" class="text-gray-600" style="position: absolute; left: calc(40% + 200px); padding-left: 1.5rem;">
      <a id="step-back-link" href="index.html" class="hover:opacity-50 cursor-pointer">Step Back</a>
    </nav>
  </header>

  <main>
    <div class="flex items-baseline mb-12">
      <div style="width: calc(40% + 200px);"></div>
      <div class="flex items-baseline" style="width: calc(60% - 200px);">
        <div id="project-description" class="description-text"></div>
      </div>
    </div>
    <div id="file-grid" class="grid grid-cols-4 sm:grid-cols-6 md:grid-cols-12 gap-x-6 gap-y-24"></div>
    <div id="loading" class="text-center text-gray-400 mt-10">Loading...</div>
  </main>

  <!-- Фулл-скрин просмотр -->
  <div id="viewerOverlay" class="fixed inset-0 hidden bg-white flex items-center justify-center z-50">
    <div id="viewerContent" class="flex items-center justify-center max-w-full max-h-full w-full h-full"></div>
  </div>

  <!-- Кастомный курсор -->
  <div id="custom-cursor"></div>

  <script src="https://player.vimeo.com/api/player.js"></script>
  <script src="js/project.js?v=80"></script>
  
  <script>
    // =============== КАСТОМНЫЙ КУРСОР ===============
    const customCursor = document.getElementById('custom-cursor');
    let cursorX = 0;
    let cursorY = 0;
    let cursorVisible = false;
    let cursorAnimationFrame = null;

    // Обновление позиции курсора
    function updateCursor(e) {
      cursorX = e.clientX;
      cursorY = e.clientY;
      
      if (customCursor) {
        customCursor.style.left = cursorX + 'px';
        customCursor.style.top = cursorY + 'px';
        
        if (!cursorVisible) {
          customCursor.style.opacity = '1';
          cursorVisible = true;
        }
      }
    }

    // Анимация курсора через requestAnimationFrame для плавности
    function animateCursor() {
      if (customCursor && cursorVisible) {
        customCursor.style.left = cursorX + 'px';
        customCursor.style.top = cursorY + 'px';
      }
      cursorAnimationFrame = requestAnimationFrame(animateCursor);
    }

    // Скрытие курсора при выходе за пределы окна
    function hideCursor() {
      if (customCursor) {
        customCursor.style.opacity = '0';
        cursorVisible = false;
      }
    }

    // Показываем курсор только на десктопе
    if (window.innerWidth >= 640) {
      document.addEventListener('mousemove', updateCursor);
      document.addEventListener('mouseenter', () => {
        if (customCursor) {
          customCursor.style.opacity = '1';
          cursorVisible = true;
        }
      });
      document.addEventListener('mouseleave', hideCursor);
      
      // Запускаем анимацию курсора
      animateCursor();
      
      // Добавляем обработчики на все iframe и их контейнеры для обновления курсора
      const observer = new MutationObserver(() => {
        // Находим все контейнеры Vimeo и добавляем обработчики
        document.querySelectorAll('[data-vimeo-id]').forEach(container => {
          container.addEventListener('mousemove', updateCursor);
          container.addEventListener('mouseenter', () => {
            if (customCursor) {
              customCursor.style.opacity = '1';
              cursorVisible = true;
            }
          });
          container.addEventListener('mouseleave', hideCursor);
        });
      });
      
      observer.observe(document.body, { childList: true, subtree: true });
    }
  </script>
</body>
</html>

